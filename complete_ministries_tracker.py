#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Complete Ministries Tracker
××¢×§×‘ ×“×¤×™ ×©×™×¨×•×ª ×¢× ×¨×©×™××” ××œ××” ×©×œ ×›×œ ×”××©×¨×“×™×
"""

import requests
import csv
import time
from datetime import datetime
import argparse

class CompleteMinistriesTracker:
    def __init__(self):
        self.session = requests.Session()
        self.session.headers.update({
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Accept': 'application/json, text/plain, */*',
            'Accept-Language': 'he-IL,he;q=0.9,en;q=0.8',
        })
        
        # ×”×©×¤×•×ª ×œ×‘×“×™×§×”
        self.languages = ['he', 'ar', 'en', 'es', 'fr', 'ru']
        self.language_names = {
            'he': '×¢×‘×¨×™×ª',
            'ar': '×¢×¨×‘×™×ª', 
            'en': '×× ×’×œ×™×ª',
            'es': '×¡×¤×¨×“×™×ª',
            'fr': '×¦×¨×¤×ª×™×ª',
            'ru': '×¨×•×¡×™×ª'
        }
        
        # ×¨×©×™××” ××œ××” ×©×œ ×›×œ ×”××©×¨×“×™× ×•×”×™×—×™×“×•×ª (××”×§×•×‘×¥ ×©×œ×š)
        self.departments = [
            ("ba3bf87e-6a99-4e24-ae89-2815a450881e", "××©×¨×“ ×”×›×œ×›×œ×” ×•×”×ª×¢×©×™×™×”"),
            ("63e7fa42-b4f5-4f28-bf80-6cae59ed55d9", "××’×£ ×' ×œ×§×™×“×•× ××•×›×œ×•×¡×™×•×ª ×”×œ×”×˜\"×‘"),
            ("e701525b-a29d-4b5c-befe-7a16eb25883b", "××’×£ ×‘×™×˜×—×•×Ÿ ×•×—×™×¨×•×"),
            ("1635cfd9-dbc7-4016-bac4-df823f106bdd", "××’×£ ×‘×›×™×¨ ××–×¨×—×™× ×•×ª×™×§×™×"),
            ("f9a91cb0-1365-46f5-b238-b5f9945ee52d", "××’×£ ×‘×›×™×¨ ×œ×¤×™×ª×•×— ×›×œ×›×œ×™ ×—×‘×¨×ª×™ ×‘×—×‘×¨×” ×”×‘×“×•××™×ª ×‘× ×’×‘"),
            ("ea0d4b20-fa34-4c7b-b739-ed25291e4e41", "××’×£ ×”××¤×§×— ×”×›×œ×œ×™ ×œ×¢× ×™×™× ×™ ×‘×™×§×•×¨×ª ×”××“×™× ×”"),
            ("019632ff-7e60-4dec-ad26-5a6fb810e34e", "××’×£ ×××©×œ ×•×—×‘×¨×”"),
            ("d1c39ee4-5b9c-4f4f-a195-7b30d22b11e3", "××’×£ ×¢×ª×•×“×•×ª ×œ×™×©×¨××œ"),
            ("e557eb8d-18dc-4ab6-8f5c-80cfd29caf11", "××’×£ ×©×•××ª ××§×¨×§×¢×™×Ÿ (×”×©×××™ ×”×××©×œ×ª×™)"),
            ("9218e4e7-f488-46f3-827f-15d225736e0e", "××¨×›×™×•×Ÿ ×”××“×™× ×”"),
            ("95ce3cb2-30d2-4d38-b44b-a694bd7ba547", "×‘×™×ª ×”× ×©×™×"),
            ("94a86de1-01ed-4a28-810c-c8baae1b0d0e", "×‘×ª×™ ×”×“×™×Ÿ ×”×“×ª×™×™× ×”×“×¨×•×–×™×™× ×‘×™×©×¨××œ"),
            ("727e39c5-a951-4cd5-9479-07de7f6b64d2", "×‘×ª×™ ×”×“×™×Ÿ ×”×¨×‘× ×™×™×"),
            ("de021da5-b740-4f6d-a8b5-43e68ff5813d", "×‘×ª×™ ×”×“×™×Ÿ ×”×©×¨×¢×™×™×"),
            ("4374079c-6952-4ccb-a70a-c97ec2132bbf", "×‘×ª×™ ×”×“×™×Ÿ ×œ××•×›×œ×•×¡×™×Ÿ ×•×”×’×™×¨×”"),
            ("924995f9-65f5-4bbd-a119-cfa6ee56bc7c", "×‘×ª×™ ×”×“×™×Ÿ ×œ×¢×‘×•×“×”"),
            ("abe9fdf6-a1d7-4b5a-a44c-9fe561e135b0", "×“×•×¨×•×ª - ××¨×›×– ×¨×¤×•××™ ×œ×©×™×§×•× ×•×’×¨×™××˜×¨×™×”"),
            ("000346dc-a071-413b-8710-7e0da217b988", "×”××’×£ ×œ××¡×“×¨×ª ××§×¦×•×¢×•×ª (×× ×”×œ×ª ×”×™×—×™×“×•×ª ×”××§×¦×•×¢×™×•×ª)"),
            ("483b9cd7-ece1-45fb-bb39-42926fc1ca84", "×”××’×£ ×œ×¨×™×©×•×™ ×›×œ×™ ×™×¨×™×™×”"),
            ("59a8638d-4c4c-477b-92f0-f545794acea1", "×”××¤×•×˜×¨×•×¤×•×¡ ×”×›×œ×œ×™ ×•×”×××•× ×” ×¢×œ ×¢× ×™×™× ×™ ×™×¨×•×©×”"),
            ("1f67b022-687d-444f-8cd9-66845a5027a4", "×”××ª×¨ ×œ×”× ×¦×—×ª ×¨×—×‘×¢× ×–××‘×™ (×’× ×“×™)"),
            ("c5c40fcb-9993-45f3-b736-f437f96bb3f3", "×”××ª×¨ ×œ×–×›×•×™×•×ª × ×¤×’×¢×•×ª ×•× ×¤×’×¢×™ ×¢×‘×™×¨×”"),
            ("60fce28b-812a-43da-8e1f-22291f728172", "×”×•×•×¢×“×” ×œ×”×§××ª ×”××©××¨ ×”×œ××•××™ ×œ×™×©×¨××œ"),
            ("f4f07761-3f3f-4c06-ba92-a4f21bb04738", "×”×—×˜×™×‘×” ×”×—×‘×¨×ª×™×ª"),
            ("aca19f98-5dc7-4c3f-b34f-0e3056068e13", "×”×™×—×™×“×” ×”×××©×œ×ª×™×ª ×œ×—×•×¤×© ×”××™×“×¢"),
            ("01dfa4c8-61a0-47e4-841d-9b90384646c0", "×”×™×—×™×“×” ×”×××©×œ×ª×™×ª ×œ×ª×™××•× ×”×××‘×§ ×‘×’×–×¢× ×•×ª"),
            ("ca1e239f-a87b-4049-980c-543c0ef159c8", "×”×™×—×™×“×” ×œ×©×™×¤×•×¨ ×”×©×™×¨×•×ª ×”×××©×œ×ª×™ ×œ×¦×™×‘×•×¨"),
            ("9c59d294-c7b9-43b8-987a-9d7b575469ed", "×”×™×—×™×“×” ×œ×©×™×ª×•×¤×™ ×¤×¢×•×œ×” ×¨×‘ ××’×–×¨×™×™×"),
            ("51155360-6a34-40c0-bde4-d7b0a90a6724", "×”××•×¡×“ ×œ×‘×™×˜×•×— ×œ××•××™"),
            ("5d2cd416-7c3f-45d1-aee3-ab390393f348", "×”××•×¢×¦×” ×”×œ××•××™×ª ×œ×›×œ×›×œ×”"),
            ("e83b1b7c-9d17-42b0-9d65-43c41745cb77", "×”××•×¢×¦×” ×œ×”× ×¦×—×ª ×–×›×¨× ×•×¤×•×¢×œ× ×©×œ × ×©×™××™ ×™×©×¨××œ ×•×¨××©×™ ×××©×œ×”"),
            ("d1641ce9-8a69-4470-9218-80fe76551921", "×”××˜×” ×”×œ××•××™ ×œ×”×’× ×” ×¢×œ ×™×œ×“×™× ×‘×¨×©×ª"),
            ("d1805730-e0d6-4c15-8ff4-baf039c0c371", "×”××˜×” ×œ×‘×™×˜×—×•×Ÿ ×œ××•××™"),
            ("9d8de85e-d7b8-4028-affe-59722a33236d", "×”××˜×” ×œ××œ×—××” ×‘×¤×©×™×¢×” ×‘×—×‘×¨×” ×”×¢×¨×‘×™×ª"),
            ("af353387-005a-4e08-9398-87f62008aaa2", "×”××™×–× ×”×œ××•××™ 265 - ×“×™×’×™×˜×œ ×‘×©×œ×˜×•×Ÿ ×”××§×•××™"),
            ("67eb85da-e2b8-4f18-b4b0-1a40e49f3acd", "×”××™× ×”×œ ×œ×—×™× ×•×š ×”×ª×™×™×©×‘×•×ª×™ ×¤× ×™××™×™×ª×™ ×•×¢×œ×™×™×ª ×”× ×•×¢×¨"),
            ("e9d11dea-f737-496c-83fe-a7748ac8448d", "×”××›×•×Ÿ ×”×’×™××•×œ×•×’×™ ×œ×™×©×¨××œ"),
            ("7baef0d0-050b-44f4-8bc9-6a6bf4a9f750", "×”××›×•×Ÿ ×œ×”×›×©×¨×” ××©×¤×˜×™×ª"),
            ("292f8223-b818-41df-a601-974f1517d712", "×”×××•× ×” ×¢×œ ×”×‘×™×§×•×¨×ª ×¢×œ ××™×“×¢ ×¤×œ×™×œ×™"),
            ("268aaf52-ffea-4801-86ed-0bf8cd5d2116", "×”×××•× ×” ×¢×œ ×”×œ×™×›×™ ×—×“×œ×•×ª ×¤×™×¨×¢×•×Ÿ ×•×©×™×§×•× ×›×œ×›×œ×™"),
            ("7c2567df-4f65-4df4-a672-d05af48612b6", "×”×××•× ×” ×¢×œ ×”×¢×–×¨×” ×”××©×¤×˜×™×ª"),
            ("9a70bba3-457a-42b5-9225-8133bf9d2b49", "×”×××•× ×” ×¢×œ × ×•×ª× ×™ ×©×™×¨×•×ª ×¢×¡×§×™"),
            ("a1db8292-6f30-4545-b391-7400a4aec3ea", "×”×× ×”×œ ×”××–×¨×—×™ ×‘×™×”×•×“×” ×•×©×•××¨×•×Ÿ"),
            ("7380f4c1-331d-40ed-af3e-41457d46eb9c", "×”×× ×”×œ×ª ×œ×¤×™×ª×•×— ××¤×¨×¥ ×—×™×¤×” ×‘××©×¨×“ ×¨××© ×”×××©×œ×”"),
            ("583263d1-8487-41f2-b12a-3e44c2b37735", "×”××¢×‘×“×” ×”×œ××•××™×ª ×œ×¡×™×™×‘×¨, ×‘×§×¨×” ×ª×¢×©×™×™×ª×™×ª, ×ª×©×ª×™×•×ª ×•×× ×¨×’×™×”"),
            ("65c63a74-c9ff-4bfc-9de8-5dbd4c062cf2", "×”××¢×¨×š ×œ×˜×§×¡×™× ×•×œ××™×¨×•×¢×™× ×××œ×›×ª×™×™×"),
            ("ae58b549-df61-42d3-89b1-6e646715c0a7", "×”××¨×›×– ×”×’×¨×™××˜×¨×™ ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ"),
            ("7cea944d-a644-4b94-b9e0-4cce71342c5d", "×”××¨×›×– ×”×§×”×™×œ×ª×™ ×œ×‘×¨×™××•×ª ×”× ×¤×© ×™×¤×•"),
            ("75d5de74-09f4-43ef-86e2-5adcc4e8b42f", "×”××¨×›×– ×”×¨×¤×•××™ ×‘× ×™ ×¦×™×•×Ÿ"),
            ("5f05fd4e-d589-4441-91cb-cf94f0cdcfee", "×”××¨×›×– ×”×¨×¤×•××™ ×–×™×•"),
            ("cb911f6a-ed61-42b9-9b98-8b5df96cfe16", "×”××¨×›×– ×”×¨×¤×•××™ ×œ×‘×¨×™××•×ª ×”× ×¤×© ××–×•×¨"),
            ("251e0205-9c1c-472c-ad16-0310c47dad98", "×”××¨×›×– ×”×¨×¤×•××™ ×¢\"×© ××“×™×ª ×•×•×œ×¤×¡×•×Ÿ"),
            ("21a0364e-1572-49b6-bafd-2debd6c3df9c", "×”××¨×›×– ×œ×‘×¨×™××•×ª ×”× ×¤×© - ××‘×¨×‘× ××œ"),
            ("85695cfc-0ff1-44fa-82b3-d9c156386d96", "×”××¨×›×– ×œ××—×§×¨ ×’×¨×¢×™× ×™ ×©×•×¨×§"),
            ("46db887d-ddff-478b-a87a-cb247bb49280", "×”××¨×›×– ×œ××™×¤×•×™ ×™×©×¨××œ"),
            ("a4558f18-657b-450e-87c3-32d70f6e07b5", "×”××©×¨×“ ×œ×‘×™×˜×—×•×Ÿ ×œ××•××™"),
            ("7807091f-2385-4915-b1cb-fd4db6d2c1cc", "×”××©×¨×“ ×œ×”×’× ×ª ×”×¡×‘×™×‘×”"),
            ("90fba09e-a331-4c19-a6d3-8301993f382e", "×”××©×¨×“ ×œ×©×•×•×™×•×Ÿ ×—×‘×¨×ª×™ ×•×§×™×“×•× ××¢××“ ×”××™×©×”"),
            ("4f415ec8-cd6c-426a-adcc-342917abae72", "×”××©×¨×“ ×œ×©×™×¨×•×ª×™ ×“×ª"),
            ("7a18aa2e-a950-4805-8b99-b438ac4df473", "×”××©×¨×“ ×œ×©×™×ª×•×£ ×¤×¢×•×œ×” ××–×•×¨×™"),
            ("0377b6f4-2c9b-4977-a8ec-0da77b0fd3ea", "×”× ×”×œ×ª ×‘×ª×™ ×”×“×™×Ÿ ×”×¨×‘× ×™×™×"),
            ("437d460e-4b84-4243-b498-bd82239048aa", "×”×¡× ×™×’×•×¨×™×” ×”×¦×™×‘×•×¨×™×ª"),
            ("74a188f9-b723-4c8c-b97e-8eb7de0c5a2f", "×”×§××¤×•×¡ ×”×“×™×’×™×˜×œ×™ ×©×œ ×‘×™×ª ×”×¡×¤×¨ ×œ×ª×™××•× ×•×§×™×©×•×¨"),
            ("e39ee324-ba36-4e15-afd6-b4c13a5dc6bc", "×”×¨×‘× ×•×ª ×”×¨××©×™×ª ×œ×™×©×¨××œ"),
            ("c7db667a-4697-48af-a432-70f213c4e74e", "×”×¨×©×•×ª ×”××¨×¦×™×ª ×œ×ª×—×‘×•×¨×” ×¦×™×‘×•×¨×™×ª"),
            ("53321058-5a80-431e-ac67-969171fcc841", "×”×¨×©×•×ª ×”×œ××•××™×ª ×œ×‘×˜×™×—×•×ª ×‘×“×¨×›×™×"),
            ("3d4cb1ea-4299-4b8a-8288-48851b62bbc3", "×”×¨×©×•×ª ×”×œ××•××™×ª ×œ×‘×™×˜×—×•×Ÿ ×§×”×™×œ×ª×™"),
            ("03919f7f-55f3-4846-a50b-4079735bf569", "×”×¨×©×•×ª ×”×××©×œ×ª×™×ª ×œ×”×ª×—×“×©×•×ª ×¢×™×¨×•× ×™×ª"),
            ("b7f4cf74-9ceb-454d-a057-e9bdc1dcdae9", "×”×¨×©×•×ª ×”×©×•×¤×˜×ª"),
            ("530572ba-73c7-4861-8bfe-e5fb712c83d6", "×”×¨×©×•×ª ×œ××™×¡×•×¨ ×”×œ×‘× ×ª ×”×•×Ÿ ×•××™××•×Ÿ ×˜×¨×•×¨"),
            ("9777687c-d21b-4fe0-b8db-372e005cdfd1", "×”×¨×©×•×ª ×œ××›×™×¤×” ×‘××§×¨×§×¢×™×Ÿ"),
            ("dd853d8a-5165-45f3-9640-f0046bdc9b76", "×”×¨×©×•×ª ×œ×”×’× ×” ×¢×œ ×¢×“×™×"),
            ("4aadba43-3d71-4e7c-a4fe-5bf47b723d4e", "×”×¨×©×•×ª ×œ×”×’× ×ª ×”×¤×¨×˜×™×•×ª"),
            ("927abd8f-4179-4bc9-927b-7178d326cbd1", "×”×¨×©×•×ª ×œ×”×’× ×ª ×”×¦×¨×›×Ÿ ×•×œ×¡×—×¨ ×”×•×’×Ÿ"),
            ("788cb851-92bd-460d-935d-dc304ff4c79d", "×”×¨×©×•×ª ×œ×–×”×•×ª ×œ××•××™×ª ×™×”×•×“×™×ª"),
            ("4c9c3099-b0e4-47f6-b593-28935df6289d", "×”×¨×©×•×ª ×œ×–×›×•×™×•×ª × ×™×¦×•×œ×™ ×”×©×•××”"),
            ("d0d64b0f-8b4e-4149-8685-54b32d80186d", "×”×¨×©×•×ª ×œ×¤×™×ª×•×— ×•×”×ª×™×™×©×‘×•×ª ×”×‘×“×•××™× ×‘× ×’×‘"),
            ("f60d1f2a-ddf1-45c0-84a2-1c1164d6dba9", "×”×¨×©×•×ª ×œ×¤×™×ª×•×— ×›×œ×›×œ×™ ×©×œ ××’×–×¨ ×”××™×¢×•×˜×™×"),
            ("94c9576f-f69e-4fcf-9274-3d705efd615f", "×”×¨×©×•×ª ×œ×¤×™×ª×•×— ×›×œ×›×œ×™-×—×‘×¨×ª×™ ×©×œ ×”××’×–×¨ ×”×—×¨×“×™"),
            ("c18a7c4d-df73-43cd-a59d-504ad68b5994", "×”×¨×©×•×ª ×œ×§×™×“×•× ××¢××“ ×”××™×©×”"),
            ("7f339ddd-6295-4025-8991-2c5a3ea2a76f", "×”×¨×©×•×ª ×œ×¨×™×©×•× ×•×”×¡×“×¨ ×–×›×•×™×•×ª ××§×¨×§×¢×™×Ÿ"),
            ("98f81ba9-af4d-4b7e-93df-01ccdf025736", "×”×¨×©×•×ª ×œ×©×™×§×•× ×”××¡×™×¨"),
            ("b7c564b6-41bd-4371-8ecf-8cda4e3099aa", "×”×¨×©×•×ª ×œ×ª×›× ×•×Ÿ ×•×¤×™×ª×•×— ×”×”×ª×™×™×©×‘×•×ª ×•×”×›×¤×¨"),
            ("9cb6d2fa-cab2-47af-b7a1-1be79cb3173d", "×”×©×™×¨×•×ª ×”××˜××•×¨×•×œ×•×’×™"),
            ("f5d85f14-2dde-43bc-a565-5c998faa4836", "×”×ª×›× ×™×ª ×”×××©×œ×ª×™×ª ×œ×©×™×œ×•×‘ ×™×•×¦××™ ××ª×™×•×¤×™×”"),
            ("9ad9b8a4-acaa-4cb3-910b-1bcf0b852322", "×•×¢×“×ª ×”×‘×“×™×§×” ×”×××©×œ×ª×™×ª ×œ××™×¨×•×¢ ×‘×¨×™×—×ª ×”××¡×™×¨×™× ×”×‘×™×˜×—×•× ×™×™× ××‘×™×ª ×¡×•×”×¨ ×’×œ×‘×•×¢"),
            ("26857f24-4eaa-4032-a39d-5dc66d374ee3", "×•×¢×“×ª ×”×‘×—×™×¨×•×ª ×”××¨×›×–×™×ª ×œ×›× ×¡×ª"),
            ("3fa88577-d5c9-4da2-a104-dfc003254043", "×•×¢×“×ª ×”×‘×—×™×¨×•×ª ×”××¨×›×–×™×ª ×œ×›× ×¡×ª ×”- 23"),
            ("74a3a304-6898-46c0-bbc3-140e02dfa856", "×•×¢×“×ª ×”×—×§×™×¨×” ×”×××œ×›×ª×™×ª ×œ×¢× ×™×™×Ÿ ×›×œ×™ ×”×©×™×˜"),
            ("e2dda42b-0ad6-49be-a997-c207b490d81b", "×•×¢×“×ª ×”××—×™×¨×™×"),
            ("4f9a783c-548c-430a-b047-2fd7a7e9972a", "×•×¢×“×ª ×”×¨×•×’×œ×•×ª"),
            ("005f611f-aaa3-4adf-9003-c30a8bc98df3", "×•×¢×“×ª ×”×©××•×ª ×”×××©×œ×ª×™×ª"),
            ("f62fc44f-1287-4e3b-9142-ffb1b70e1732", "×•×¢×“×ª ×—×§×™×¨×” ×××œ×›×ª×™×ª - ××¡×•×Ÿ ××™×¨×•×Ÿ"),
            ("03f84303-ed13-445d-84c2-e198be456005", "×•×¢×“×ª ×¢×¨×¨ ×œ×¢× ×™×™× ×™ ×§×•×¨×•× ×” ×•×—×¨×‘×•×ª ×‘×¨×–×œ â€“ ××¡×œ×•×œ ××¨×¦×™"),
            ("8a705253-c5fd-41f7-984b-0c57e90a8ce6", "×—×•×¤×© ×”××™×“×¢"),
            ("63db92ca-11c9-448a-b36c-1084990322e2", "×—× ×™× ×•×ª"),
            ("ba9f3048-d2da-452c-8e78-b569ed10c6e2", "×—×¨×‘×•×ª ×‘×¨×–×œ - ××™×“×¢ ×œ×¦×™×‘×•×¨ ×××©×¨×“×™ ×”×××©×œ×”"),
            ("5d035cf2-da5b-497d-bd41-2a7e3ea2cf6c", "×™×™×¢×•×¥ ×•×—×§×™×§×”"),
            ("182e15d2-c8d7-403f-9f30-b3e4df8e5e68", "×›×‘××•×ª ×•×”×¦×œ×” ×œ×™×©×¨××œ"),
            ("be3be8b2-3997-4c88-9441-2dcdf7ab7d54", "×œ×©×›×ª ×”×¢×™×ª×•× ×•×ª ×”×××©×œ×ª×™×ª"),
            ("a6220daf-0ab3-420d-92f0-58581b90b3e0", "×.×”.×œ.×‘ - ××¨×›×– ×”×©×œ×™×˜×” ×œ××©×¤×—×•×ª ×”× ×¢×“×¨×™× ×•×”×—×˜×•×¤×™×"),
            ("caea8076-c7bf-4763-9874-788ddc19d2cb", "××’×–×™×Ÿ × ×§×•×“×ª ××‘×˜"),
            ("0c2a6dd6-5bca-48d2-9759-c7be174296fa", "××’×Ÿ ×“×•×“ ××“×•× ×‘×™×©×¨××œ"),
            ("07899167-3cf5-4df0-8076-bcecbfee654e", "××•×¢×¦×ª ×¨×©×•×ª ×”××™×"),
            ("646c0727-7b0a-43df-ba17-030576fac3d5", "××•×§×“ ××¢× ×” ×××©×œ×ª×™ ××¨×›×–×™"),
            ("394045a2-fa40-4cd0-b50a-eede694611b0", "××•×¨×©×ª ×™×©×¨××œ ×‘×”×¨ ×”×‘×™×ª"),
            ("1bf4afc0-95a3-4f2b-8993-2f3db7216134", "××–×›×™×¨×•×ª ×”×××©×œ×”"),
            ("51538cbb-494c-4da1-93f3-e52418139351", "××—×œ×§×ª ×”××—×§×¨ ×©×œ ×”×¨×©×•×ª ×”×©×•×¤×˜×ª"),
            ("c56e9681-ce7c-4d75-aa1e-75127fe0ded7", "××—×œ×§×ª ×—× ×™× ×•×ª"),
            ("1c312527-6a7e-4af7-8fe6-22f4da333159", "××˜×” ×”××™×–× ×”×œ××•××™ ×™×©×¨××œ ×“×™×’×™×˜×œ×™×ª, ×‘××©×¨×“ ×œ×©×•×•×™×•×Ÿ ×—×‘×¨×ª×™"),
            ("2574c957-2109-4270-9586-62ca2d37857e", "××™× ×”×œ ×”×ª×›× ×•×Ÿ"),
            ("7081db9d-0090-4d60-b129-b492b9f5f6eb", "×× ×”×œ×ª ×ª×—×‘×•×¨×” ×—×›××” ×‘××©×¨×“ ×¨××© ×”×××©×œ×”"),
            ("a8d3ea59-df3b-4dd6-acd9-26c09079570b", "××¢× ×§×™× ×•×”×˜×‘×•×ª ×œ×ª×¢×©×™×™× ×™×"),
            ("7e3f29d6-998e-46d0-91ca-ccefc673fcfc", "××¢×¨×š ×”×’×™×•×¨"),
            ("81118354-e792-4e08-9057-f7ae5200cbf9", "××¢×¨×š ×”×“×™×’×™×˜×œ ×”×œ××•××™"),
            ("4bcc13f5-fed6-4b8c-b8ee-7bf4a6bc81c8", "××¢×¨×š ×”×¡×™×™×‘×¨ ×”×œ××•××™"),
            ("c2185409-df16-49c4-911d-34f718bb7929", "××¢×¨×›×ª ×”×”×–×“×”×•×ª ×”×œ××•××™×ª"),
            ("ea0ef5ea-c465-4ead-811e-4c8e59e40be5", "××¢×¨×›×ª ×ª××¨ (×ª×›× ×•×Ÿ ×××©×œ×ª×™ ×¨×•×—×‘×™) â€“ ×—×•××¨×™ ×¢×–×¨"),
            ("8098245a-163b-4fbe-88e9-f57e11532d8f", "××¨×—×‘×™× â€“ ×”××¨×›×– ×”×¨×¤×•××™ ×œ×˜×™×¤×•×œ ×‘××•×— ×•×‘× ×¤×©, ×‘××¨ ×™×¢×§×‘ × ×¡ ×¦×™×•× ×”"),
            ("4153ab18-52bb-42dc-a347-b513faa428ca", "××¨×›×– ×”××™×“×¢ ×•×”×™×“×¢ ×”×œ××•××™ ×œ××¢×¨×›×” ×‘×§×•×¨×•× ×”"),
            ("ca300f4a-d232-43bc-ac7e-6bde735403d2", "××¨×›×– ×¨×¤×•××™ ×¤×œ×™××Ÿ"),
            ("2042b1a4-5ec1-44a9-84dc-764b19864cfa", "××©×˜×¨×ª ×™×©×¨××œ"),
            ("f41159c1-7867-41c3-bc0a-cbfe0da1bb1a", "××©×¨×“ ×”××•×¦×¨"),
            ("0caee7eb-1ebb-4c12-9ed8-7dce94badcb2", "××©×¨×“ ×”×× ×¨×’×™×” ×•×”×ª×©×ª×™×•×ª"),
            ("7566b0f1-c9a4-4af7-ab01-d34ca3a52104", "××©×¨×“ ×”×‘×™×˜×—×•×Ÿ"),
            ("c515b1b2-3163-499e-bdbd-8849147c5ada", "××©×¨×“ ×”×‘×™× ×•×™ ×•×”×©×™×›×•×Ÿ"),
            ("104cb0f4-d65a-4692-b590-94af928c19c0", "××©×¨×“ ×”×‘×¨×™××•×ª"),
            ("75b82171-30fd-4b5b-84a6-3fcb827506a6", "××©×¨×“ ×”×“×™×’×™×˜×œ ×”×œ××•××™"),
            ("39c1fee9-74d5-4091-a5c0-8c921676c992", "××©×¨×“ ×”×”×¡×‘×¨×”"),
            ("389346b9-e5ec-46a7-abde-102bee0945b4", "××©×¨×“ ×”×”×©×›×œ×” ×”×’×‘×•×”×” ×•×”××©×œ×™××”"),
            ("0fc59189-491d-45c5-9992-0fcc067fd509", "××©×¨×“ ×”×”×ª×™×™×©×‘×•×ª ×•×”××©×™××•×ª ×”×œ××•××™×•×ª"),
            ("75d0cbd7-46cf-487b-930c-2e7b12d7f846", "××©×¨×“ ×”×—×“×©× ×•×ª, ×”××“×¢ ×•×”×˜×›× ×•×œ×•×’×™×”"),
            ("6cbf57de-3976-484a-8666-995ca17899ec", "××©×¨×“ ×”×—×•×¥"),
            ("3a4dfc8a-ac31-4ab4-8734-35090ae3bb06", "××©×¨×“ ×”×—×™× ×•×š"),
            ("920e5116-ca8b-4bb5-b54c-6a518d3d94b9", "××©×¨×“ ×”×—×§×œ××•×ª ×•×‘×™×˜×—×•×Ÿ ×”××–×•×Ÿ"),
            ("5c7214c6-6571-43b1-9474-a0541e7afd94", "××©×¨×“ ×”××•×“×™×¢×™×Ÿ"),
            ("6ade9ef2-44fb-416b-a430-0e9475933ad8", "××©×¨×“ ×”××•×¨×©×ª"),
            ("86842de6-987b-42d4-b9c2-cbd7d0619534", "××©×¨×“ ×”××©×¤×˜×™×"),
            ("1f628453-da79-4549-8c12-1073a718c9b0", "××©×¨×“ ×”× ×’×‘, ×”×’×œ×™×œ ×•×”×—×•×¡×Ÿ ×”×œ××•××™"),
            ("85d16bf0-1c3e-486a-97cd-2b07d89e6934", "××©×¨×“ ×”×¢×‘×•×“×”"),
            ("27db3169-ab0e-490c-af70-6d03133cb1f3", "××©×¨×“ ×”×¢×œ×™×™×” ×•×”×§×œ×™×˜×”"),
            ("bbdbfb50-7ef3-4e3b-9718-f40f011283c6", "××©×¨×“ ×”×¤× ×™×"),
            ("4fa63b79-3d73-4a66-b3f5-ff385dd31cc7", "××©×¨×“ ×”×¨×•×•×—×” ×•×”×‘×™×˜×—×•×Ÿ ×”×—×‘×¨×ª×™"),
            ("48eaee91-0c97-4ef3-b364-50ae52e3b56f", "××©×¨×“ ×”×ª×—×‘×•×¨×” ×•×”×‘×˜×™×—×•×ª ×‘×“×¨×›×™×"),
            ("d6b46ce2-975b-43ee-afbd-404ba29b01e8", "××©×¨×“ ×”×ª×™×™×¨×•×ª"),
            ("1213ca14-4263-4720-b7bf-afa8e8c05444", "××©×¨×“ ×”×ª×¤×•×¦×•×ª ×•×”×××‘×§ ×‘×× ×˜×™×©××™×•×ª"),
            ("503be068-3051-4dc0-bc61-65f0b33f0570", "××©×¨×“ ×”×ª×§×©×•×¨×ª"),
            ("7d5d01a1-c043-4c87-b8ef-5061999e797c", "××©×¨×“ ×”×ª×¨×‘×•×ª ×•×”×¡×¤×•×¨×˜"),
            ("1a053147-b15c-436e-b057-d3b8ee050eb8", "××©×¨×“ ×™×¨×•×©×œ×™× ×•××¡×•×¨×ª ×™×©×¨××œ"),
            ("a9e7fc28-9bce-42cd-9c58-01a8591f08df", "××©×¨×“ ××©××‘×™ ×”××™×"),
            ("e744bba9-d17e-429f-abc3-50f7a8a55667", "××©×¨×“ ×¨××© ×”×××©×œ×”"),
            ("4cd935d1-d6ec-4336-8ae1-d337c8c82d05", "××©×¨×“ ×¨××© ×”×××©×œ×”, \"× ×ª×™×‘\""),
            ("5f766f7f-0864-4387-be3b-899ea97d69c8", "× ×™××‘×•×¡ Cloud Me In"),
            ("9a6c04df-2d47-4764-9139-37f085b5965c", "× ×¦×™×‘×•×ª ×©×•×•×™×•×Ÿ ×–×›×•×™×•×ª ×œ×× ×©×™× ×¢× ××•×’×‘×œ×•×ª"),
            ("bfe22d82-2309-43ff-94d7-1eeb873ab368", "× ×¦×™×‘×•×ª ×©×™×¨×•×ª ×”××“×™× ×”"),
            ("28222f50-52bd-4fd1-8800-6a39d7b13c6b", "× ×¦×™×‘×•×ª ×ª×œ×•× ×•×ª ×”×¦×™×‘×•×¨ ×¢×œ ××™×™×¦×’×™ ×”××“×™× ×” ×‘×¢×¨×›××•×ª (× ×ª×)\""),
            ("bd9833d0-469e-4db5-a09c-08642b44fb22", "× ×¦×™×‘×•×ª ×ª×œ×•× ×•×ª ×”×¦×™×‘×•×¨ ×¢×œ ×©×•×¤×˜×™×"),
            ("e8330bd2-d0d4-41fd-a4c6-6d57fef58a6d", "× ×ª× ×• ×—×™×™× â€“ ××ª×¨ ×œ×”× ×¦×—×ª ×ª×•×¨××™ ××™×‘×¨×™×"),
            ("a1fc9212-7c88-4029-b749-97fbf3a6fd85", "×¡×™×•×¢ ××©×¤×˜×™"),
            ("2cc21633-4d80-40bb-9733-b7c70dfeb07f", "×¢×œ-×”×§×•"),
            ("18c1d592-7526-4026-a295-38e3d47538e2", "×¤×•×¨×˜×œ ×××©×œ×ª×™ - ××‘×¦×¢ \"×¢× ×›×œ×‘×™×\""),
            ("c3279401-77b2-4d0b-9598-940fbb55c049", "×¤×¨×§×œ×™×˜×•×ª ×”××“×™× ×”"),
            ("2c50a510-1668-4226-9ba3-bb71b1962d85", "×¨×©×•××•×ª"),
            ("95b283ad-fc02-40e6-ac6f-8986acac6b86", "×¨×©×•×ª ×”××•×›×œ×•×¡×™×Ÿ ×•×”×”×’×™×¨×”"),
            ("c673e628-43e7-40e5-9610-19b2ffabce3b", "×¨×©×•×ª ×”××›×™×¤×” ×•×”×’×‘×™×™×”"),
            ("c70a663b-34fd-4c56-8911-57e5f2d7ad8f", "×¨×©×•×ª ×”××¡×“×¨×”"),
            ("b383f304-38b6-4112-b4a8-1253800d8702", "×¨×©×•×ª ×”×—×‘×¨×•×ª ×”×××©×œ×ª×™×•×ª"),
            ("c1d2ec1c-7f78-4d96-a739-1ed90f9e2b4b", "×¨×©×•×ª ×”×—×©××œ"),
            ("854325f0-0e0b-4531-833d-ae72b3e43a28", "×¨×©×•×ª ×”×××’×¨ ×”×‘×™×•××˜×¨×™ ×”×œ××•××™"),
            ("e9952141-a088-4a16-bf28-cd0255126ebe", "×¨×©×•×ª ×”××˜×¨×•"),
            ("d226daa2-e5c0-4595-b0d1-fe8e52110032", "×¨×©×•×ª ×”××™×"),
            ("c0d8ba69-e309-4fe5-801f-855971774a90", "×¨×©×•×ª ×”××¡×™× ×‘×™×©×¨××œ"),
            ("4b7bb398-52f7-45a1-8722-6cec1bd45733", "×¨×©×•×ª ×”×¡×¤× ×•×ª ×•×”× ××œ×™×"),
            ("4ce56f25-7d6d-4f2c-991a-2e87d984494d", "×¨×©×•×ª ×”×¤×˜× ×˜×™×"),
            ("5973c473-0eef-429c-98be-bb85a0534c7c", "×¨×©×•×ª ×”×¦×¢×™×¨×™×"),
            ("1195ce53-2541-4214-8ad1-72d5273b4626", "×¨×©×•×ª ×”×©×™×¨×•×ª ×”×œ××•××™-××–×¨×—×™"),
            ("8b4e2a06-8ce1-4703-8895-c35be965ef1f", "×¨×©×•×ª ×”×ª××’×™×“×™×"),
            ("51752c15-473a-4c15-959f-e719cb113529", "×¨×©×•×ª ×”×ª×—×¨×•×ª"),
            ("1b2155ee-aceb-477f-93bc-9b03af86782e", "×¨×©×•×ª ×”×ª×¢×•×¤×” ×”××–×¨×—×™×ª"),
            ("806561c8-659a-4fbb-9b8f-8ecc1e6b8164", "×¨×©×•×ª ××§×¨×§×¢×™ ×™×©×¨××œ"),
            ("809fb74a-67c7-4c4b-a8ad-86dd24786117", "×¨×©×•×ª ×©×•×§ ×”×”×•×Ÿ, ×‘×™×˜×•×— ×•×—×™×¡×›×•×Ÿ"),
            ("c8f3032c-34e6-44f6-88f7-8098122456f9", "×¨×©× ×”×–×•×’×™×•×ª ×•×”×™×—×™×“×” ×œ×¢× ×™×™× ×™ ×¢×“×•×ª ×“×ª×™×•×ª"),
            ("3e786d06-1b9d-4db1-abc5-ceef72e5132e", "×©×•×ª×¤×•×™×•×ª ×¨×‘ ××’×–×¨×™×•×ª ×•×©×™×ª×•×£ ×¦×™×‘×•×¨"),
            ("c3f24c3b-9940-45c2-82a1-c4be2087bf99", "×©×™×¨×•×ª ×‘×ª×™ ×”×¡×•×”×¨"),
            ("74cf2e77-97f0-4a0e-8874-4166450059df", "×©×™×¨×•×ª ×”×ª×¢×¡×•×§×” ×”×™×©×¨××œ×™"),
            ("0e349524-943c-4fd5-a99c-4e3e6556c6e6", "×©×™×ª×•×£ ×¦×™×‘×•×¨"),
            ("bbb9e22c-cdf6-434e-bdfb-40d8c26be29d", "×ª×•×›× ×™×ª ×œ××•××™×ª ×œ×× ×™×¢×ª ××•×‘×“× ×•×ª"),
            ("8f505fb3-cfb2-4745-b02c-36f50212f2e8", "×ª×™××•× ×”×××‘×§ ×‘×¡×—×¨ ×‘×‘× ×™ ××“×"),
            ("f79320cc-188a-43ed-84f2-6b60fe464ad4", "×ª×™××•× ×¤×¢×•×œ×•×ª ×”×××©×œ×” ×‘×©×˜×—×™×"),
            ("a44d7eeb-c006-4db7-96a6-cf619fd06eae", "×ª×¢×•×¤×” ×‘×–××Ÿ ×§×•×¨×•× ×”")
        ]

    def get_services_count(self, dept_id: str, language: str) -> int:
        """×§×‘×œ×ª ××¡×¤×¨ ×“×¤×™ ×”×©×™×¨×•×ª×™× ×¢×‘×•×¨ ××©×¨×“ ×‘×©×¤×” ××¡×•×™××ª"""
        
        url = f"https://www.gov.il/{language}/api/GeneralApi/GetModel"
        params = {
            'ModelName': 'Service',
            'OfficeTaxonomy': dept_id,
            'PageSize': 1,
            'PageNumber': 1
        }
        
        try:
            response = self.session.get(url, params=params, timeout=10)
            
            if response.status_code == 200:
                data = response.json()
                return data.get('totalResults', 0)
                
        except Exception:
            pass
            
        return 0

    def scan_department(self, dept_id: str, dept_name: str) -> dict:
        """×¡×¨×™×§×ª ××©×¨×“ ×™×—×™×“"""
        
        measurement_date = datetime.now().strftime("%B %d, %Y")
        
        dept_data = {
            '×ª××¨×™×š_××“×™×“×”': measurement_date,
            '×©×_×”××©×¨×“': dept_name,
            '××–×”×”_××©×¨×“': dept_id
        }
        
        total_services = 0
        
        for lang in self.languages:
            count = self.get_services_count(dept_id, lang)
            dept_data[self.language_names[lang]] = count
            total_services += count
            time.sleep(0.1)
        
        dept_data['×¡×”_×›'] = total_services
        return dept_data

    def scan_all(self, sample_size: int = None) -> list:
        """×¡×¨×™×§×ª ×›×œ ×”××©×¨×“×™×"""
        
        departments_to_scan = self.departments
        
        if sample_size:
            departments_to_scan = departments_to_scan[:sample_size]
            print(f"ğŸ¯ ×‘×•×“×§ ×“×’×™××” ×©×œ {sample_size} ××©×¨×“×™×")
        else:
            print(f"ğŸ” ×‘×•×“×§ ××ª ×›×œ {len(departments_to_scan)} ×”××©×¨×“×™×")
            
        print("-" * 60)
        
        results = []
        
        for i, (dept_id, dept_name) in enumerate(departments_to_scan, 1):
            print(f"[{i:3}/{len(departments_to_scan)}] {dept_name[:45]}...")
            
            dept_data = self.scan_department(dept_id, dept_name)
            results.append(dept_data)
            
            if dept_data['×¡×”_×›'] > 0:
                lang_summary = []
                for lang_name in self.language_names.values():
                    count = dept_data[lang_name]
                    if count > 0:
                        lang_summary.append(f"{lang_name[:2]}: {count}")
                
                print(f"    âœ… {dept_data['×¡×”_×›']} ×“×¤×™× ({', '.join(lang_summary)})")
            else:
                print(f"    âŒ ××™×Ÿ ×©×™×¨×•×ª×™×")
        
        return results

    def save_to_csv(self, results: list, filename: str = None) -> str:
        """×©××™×¨×ª ×”×ª×•×¦××•×ª ×œ-CSV"""
        
        if not filename:
            timestamp = datetime.now().strftime("%Y%m%d_%H%M")
            filename = f"govil_complete_{timestamp}.csv"
        
        fieldnames = [
            '×ª××¨×™×š_××“×™×“×”', '×©×_×”××©×¨×“', '×¢×‘×¨×™×ª', '×¢×¨×‘×™×ª', 
            '×× ×’×œ×™×ª', '×¡×¤×¨×“×™×ª', '×¦×¨×¤×ª×™×ª', '×¨×•×¡×™×ª', '×¡×”_×›', '××–×”×”_××©×¨×“'
        ]
        
        results.sort(key=lambda x: x['×¡×”_×›'], reverse=True)
        
        with open(filename, 'w', newline='', encoding='utf-8-sig') as csvfile:
            writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
            writer.writeheader()
            writer.writerows(results)
        
        print(f"ğŸ’¾ × ×©××¨: {filename}")
        return filename

    def print_summary(self, results: list):
        """×”×“×¤×¡×ª ×¡×™×›×•×"""
        
        results_with_services = [r for r in results if r['×¡×”_×›'] > 0]
        total_services = sum(r['×¡×”_×›'] for r in results_with_services)
        
        print("\n" + "="*60)
        print("ğŸ“Š ×¡×™×›×•×")
        print("="*60)
        print(f"×¡×”\"×š × ×‘×“×§×•: {len(results)} ××©×¨×“×™×")
        print(f"×¢× ×©×™×¨×•×ª×™×: {len(results_with_services)} ××©×¨×“×™×")
        print(f"×¡×”\"×š ×“×¤×™ ×©×™×¨×•×ª: {total_services:,}")
        
        if total_services > 0:
            print("\n×œ×¤×™ ×©×¤×•×ª:")
            for lang_name in self.language_names.values():
                lang_total = sum(r[lang_name] for r in results_with_services)
                percentage = (lang_total / total_services * 100) if total_services > 0 else 0
                print(f"  {lang_name}: {lang_total:,} ({percentage:.1f}%)")
            
            print("\n××©×¨×“×™× ××•×‘×™×œ×™×:")
            for i, r in enumerate(results_with_services[:10], 1):
                print(f"{i:2}. {r['×©×_×”××©×¨×“']}: {r['×¡×”_×›']} ×“×¤×™×")

def main():
    parser = argparse.ArgumentParser(description="××¢×§×‘ ×“×¤×™ ×©×™×¨×•×ª - ×›×œ ×”××©×¨×“×™×")
    parser.add_argument("--output", "-o", help="×§×•×‘×¥ CSV ×¤×œ×˜")
    parser.add_argument("--sample", type=int, help="×“×’×™××” ×©×œ N ××©×¨×“×™×")
    parser.add_argument("--quiet", "-q", action="store_true", help="×¤×—×•×ª ×¤×œ×˜")
    
    args = parser.parse_args()
    
    tracker = CompleteMinistriesTracker()
    
    try:
        print("ğŸš€ ××¢×§×‘ ×“×¤×™ ×©×™×¨×•×ª - ×›×œ ×”××©×¨×“×™× ×”×××©×œ×ª×™×™×")
        print(f"â° {datetime.now().strftime('%d/%m/%Y %H:%M')}")
        print(f"ğŸ“‹ {len(tracker.departments)} ××©×¨×“×™× ×•×™×—×™×“×•×ª ×‘×¨×©×™××”")
        print()
        
        results = tracker.scan_all(args.sample)
        
        if results:
            csv_file = tracker.save_to_csv(results, args.output)
            
            if not args.quiet:
                tracker.print_summary(results)
            
            print(f"\nâœ… ×”×•×©×œ×! ×§×•×‘×¥: {csv_file}")
            
        else:
            print("âŒ ××™×Ÿ ×ª×•×¦××•×ª")
            
    except KeyboardInterrupt:
        print("\nâŒ ×”×•×¤×¡×§ ×¢×œ ×™×“×™ ×”××©×ª××©")
    except Exception as e:
        print(f"âŒ ×©×’×™××”: {e}")

if __name__ == "__main__":
    main()
